FORMAT: 1A

# IMP North: Ready

# Introduction

This is a description of rest interfaces ready to be implemented in IMP.
        
# Group Heatmap
This is a group of all rest resources related to heatmap as PNG file. Heat map is a graphical representation of data where the individual values are represented as colors
Currently it is planned to be used to represent two service categories: CarSharing and BikeSharing services

## CarSharing Heatmap [/imp-endpoint/api/V1/Info/Heatmap/CarSharing?date={x}&left_lower_lat={lllat}&left_lower_lng={lllng}&right_upper_lng={rulng}&right_upper_lat={rulat}&operatorList={operatorList}]    
Get WMS PNG file for carSharing for a specific date, for a specific bounding box (place) and for specific free-floating carSharing operators (Car2Go_Berlin, DriveNow, etc.)

### Getting heatmap as PNG image [GET]

+ Parameters
    + date (required, string, `1404892800000`) ... a date in the history (later also in the future) Has example value.
    + lllat (required, string, `52.482780222078205`) ... 
    + lllng (required, string, `13.3154296875`) ...     
    + rulng (required, string, `13.359375`) ... 
    + rulat (required, string, `52.50953477032729`) ... 
    + operatorList (optional, string, `Car2Go_Berlin,DriveNow`) ... comma-separated list of CarSharing operator ids. If not specified -> returns image for all available _CarSharing_ operators

+ Request

    + Headers
        
            accept: image/png 

+ Response 200 (image/png)

    + Body
    
            �PNG

## BikeSharing Heatmap [/imp-endpoint/api/V1/Info/Heatmap/BikeSharing?date={x}&left_lower_lat={lllat}&left_lower_lng={lllng}&right_upper_lng={rulng}&right_upper_lat={rulat}&operatorList={operatorList}]    
Get WMS PNG file for carsharing for a specific date, a specific bounding box (place) and for specific free-floating bikeSharing providers (NextBike, etc.)

### Getting heatmap as PNG image [GET]

+ Parameters
    + date (required, string, `1404892800000`) ... a date in the history (later also in the future) Has example value.
    + lllat (required, string, `52.482780222078205`) ... 
    + lllng (required, string, `13.3154296875`) ...     
    + rulng (required, string, `13.359375`) ... 
    + rulat (required, string, `52.50953477032729`) ... 
    + operatorList (optional, string, `NextBike,CallABike`) comma-separated list of BikeSharing operator ids. If not specified -> returns image for all available _BikeSharing_ operators

+ Request

    + Headers
        
            accept: image/png 

+ Response 200 (image/png)

    + Body
    
            �PNG



# Group Parking
This is a group of all parking related rest resources. Parking Garages & On-street Parking Vacancies

## On-street Parking Vacancies with Basic Info [/imp-endpoint/api/V1/Resources/Parking/OnStreetVacancies?lat={lat}&lng={lng}&radius={radius}?length={length}&width={width}&unit={unit}]    
This collection contains a list of all on-street vacansies in an area of interest specified by query parameters together with an URI to acquire more details about a specific vacancy.
TODO: the list contains only vacancies (FREE parking spots, no OCCUPIED parking spots!)
Note: The area of interest can be defined as:

* a bounding circle (lat={lat}&lng={lng}&radius={radius})
* a bounding box (left_lower_lat={min_lat}&left_lower_lng={min_lng}&right_upper_lat={max_lat}&right_upper_lng={max_lng})

The If-Modified-Since (optional) can be set to a specific date-time in order to request only resources modified after a particular date-time.
Date time in HTTP date format for e.g. Wed, 09 Apr 2008 23:55:38 GMT
TODO: Does not make sense now, but maybe in the future..

The data structure of the response contains the following attributes:

attribute | json data type | comments
--- | --- | ---
metadata | Object | List of service providers and the last update times and failures if any [{serviceAlias:"XXX",lastUpdateTime:dd-mm-yyyyThhmmssZ,messages:[]}]
--- | --- | ---
resources | Array | Array of resources within the search area
--- | --- | ---
actions | Array | List of available actions on this resource (currently empty, in the future can be subscribe for changes...)
id | Number | Internal parking spot identification number
description | String | description
type | String | (="OnStreetParkingVacancy" or similar) TODO
uri | URI | URI to request more details
location | Object | Standard WGS 84 for polar coordinates { "latitude":Number, "longitude":Number, "system": ENUM{"WGS_84","GK4","ETRS89",...}  } 
provider | String | Parking service provider (usually equals operator)
operator | String | Parking space operator (usually equals provider)
category | ENUM | public, resident, handicapped

TODO: The following parameters are available in parking garages and should be discussed if they make sense in parking vacancies:

attribute | json data type | comments
--- | --- | ---
availability | Double | Availability in percentage
totalnumber | Object | Number of lots for different categories { "handicappedOnly":Int, "womenOnly":Int, "others":Int }
lottype | Enum | Type of garage {"Parkhaus", "Parkzone", "Tiefgarage", "Parkplatz"} 
modFlag | Enum | Type of modification to resource [New / Modified / Relocated / Deleted]. This attribute is present only when the If-Modified-Sinceodified-Since header is passed in the request 

Parts of the data structure might be omitted if the information is not available. 
    
### Getting on-street parking vacancies [GET]
@nottestable

+ Parameters
    + lat (string, `52.52`) ... String `lat` latitude value. Has example value.
    + lng (string, `13.39`) ... String `lng` longitude value. Has example value.
    + radius (string, `1000`) ... String `radius` radius value. Has example value.
    + length (optional, string, `5`) ... String `length` required length value (car size). Has example value. If not defined a default value is used
    + width (optional, string, `2.5`) ... String `width` required width value (car size). Has example value. If not defined a default value is used
    + unit (optional, string, `m`) ... String `unit` measurement unit for the size value. Has example value. If not defined a default value is used
    
+ Request

    + Headers
    
            If-Modified-Since: Wed, 09 Apr 2008 23:55:38 GMT 
        
+ Response 200 (application/json)   

        {
            "metaData": [
                {
                    "serviceAlias": "city2.e??",
                    "lastUpdateTime": "2014-07-10T11:11:04+0200",
                    "messages": []
                }
            ],
            "resources": [
                {
                    "actions": [],
                    "id": 270113,
                    "description": "Some description",
                    "type": "OnStreetParkingVacancy",
                    "uri": "Resources/Parking/OnStreetVacancies/270113",
                    "location": {
                        "latitude": 52.51908,
                        "longitude": 13.39094,
                        "system": "WGS_84"
                    },
                    "provider": "city2.e..",
                    "operator": "city2.e..",
                    "category": "handicapped"
                }
            ]
        }

## Parking Vacancy with Detailed Info [/imp-endpoint/api/V1/Resources/Parking/OnStreetVacancies/{id}]

A single parking vacancy object with Detailed Information. 
The data structure of the response contains the attributes with the basic information and additionally the following attributes:

attribute | json data type | comments
--- | --- | ---
... | ... | ...
pricing | String | Price structure 
payment | Array | Payment options {COINPAY, BANKNOTEPAY, BANKCARDPAY, CREDICARDPAY, PREPAIDCARDPAY, PAYCARDPAY, DEBITPAY}
bookable | Boolean |  
allowedStay | Object | Allowed stay { "value": Number, "unit": String } 
restrictions | Array | Usage restrictions {"VisitorsOnly","GuestsOnly"}
services | Array | Special services { "WomenParking", "DisabledParking", "Monitored", "ChargingStation", "ParentChild", "MotorCycle", ... } 
securityComment | String |  Securtiy features

### Getting a specific parking vacancy [GET] 
@nottestable

+ Parameters
    + id (string, `8367`) ... String `id` as retrieved through *[/imp-endpoint/api/V1/Resources/Parking/OnStreetVacancies?lat={lat}&lng={lng}&radius={radius}]*

+ Response 200 (application/json) 

        {
            "actions": [],
            "id": 271366,
            "description": "Some description",
            "type": "OnStreetParkingVacancy",
            "uri": "Resources/Parking/OnStreetVacancies/270113",
            "location": {
                "latitude": 52.51908,
                "longitude": 13.39094,
                "system": "WGS_84"
            },
            "provider": "city2.e..",
            "operator": "city2.e..",
            "category": "handicapped",
            "pricing": "2,00 EUR für die 1. Std. <br>2. und 3. Stunde 1,50 Euro<br>je weiter Stunde 1,00 Euro<br>Tagespreis 15,00 Euro<br>Monatspreis 100,00 Euro",
            "payment": [
                "BANKNOTEPAY",
                "COINPAY"
            ],
            "bookable": false,
            "allowedStay": null,
            "restrictions": null,
            "services": null,
            "securityComment": null
        }


# Group Routing
This is a group of all routing related rest resources?

## One to many routes [/imp-endpoint/api/V1/TripProposals/XRouter_one2n]    
This collection contains trip proposals with basic information for specified trip criteria.
Note: the trip proposals can be multimodal or intermodal, depending on to which routing service the user is subscribed to.
Note: the trip proposals one to one or one to many: depending on to which routing service the user is subscribed to?
The data structure of the response contains the following attributes:

attribute | json data type | comments
--- | --- | ---
url | URI | URI to request more details
origin | Object | start point of the proposed trip
destination | Object | endpoint of the proposed trip
trafficTypes | Array | list of traffic types used in the proposed trip. Currently: Bike, Bus, Car, CityTrain, Ferry, Metro, Other, RegioTrain, Unknown, Train, Tram, Walk, UBahn. trafficType Other is used in the segments for car rental/parking
description | String | 
costs | Array | list of costs for the proposed trip
useBikeSharing | Boolean | use bike sharing services for routing [default: false]
useCarSharing | Boolean | use car sharing services for routing [default: false]
--- | --- | ---
ownVehicles | Object | 
--- | --- | ---
trafficType | Enum | Own vehicle type - Car / Bike
useParking | Boolean | Use parking for own vehicle 
useParkAndRide | Boolean | Use parking and ride for own vehicle 

    
+ Model (application/json)
        
        [
            {}
        ]
